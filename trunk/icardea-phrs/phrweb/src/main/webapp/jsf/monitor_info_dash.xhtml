<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.prime.com.tr/ui"
                template="/templates/template_ui.xhtml">

<ui:define name="head">


    <style type="text/css">
        .table.innertable td {
            border: 0;
        }
    </style>
    <ui:insert name="head"></ui:insert>
</ui:define>
<!--
   currentUserId;
   currentUserOwnerUri;
   currentUserRole;

   ownerUri;
   protocolId;
   name;

   resourceType;// resourcecode
   not needed at this level
   allowedViewRow
   allowedViewContent
   consentViewContent
   request param

   ?resourcecode=#{theItem.resourceType}&amp;phrid=#{theItem.ownerUri}
   protocolid
   target="_blank"
   resourcecode phrid
either new page or

selectedOwnerUri
selectedLocalResourceType
selectedTest

modelFormUserList
modelFormLocalResources

-->

<ui:define name="content">

<p:fieldset legend="Monitor Personal Health Information">
<!--update="idPanelObp" -->
<h:form>
    <p:growl id="msgs" showDetail="true"/>
    <!--<p:toolbar>
        <p:toolbarGroup align="left">   -->
            <h:panelGroup>

                <h:panelGroup rendered="#{monmgtBean.showFormType eq 'ROLEGROUP_MEDICAL'}">
                    <h:outputLabel value="Patient:" />
                    <h:selectOneMenu id="field_2_input"
                                     required="true"  requiredMessage="Please select a user"
                                     layout="pageDirection"
                                     value="#{monmgtBean.selectedOwnerUri}">

                        <f:selectItem itemLabel="Please select a User" noSelectionOption="true"
                                      itemValue=""/>
                        <f:selectItems
                                value="#{monmgtBean.selectedOwnerUri}"
                                var="lv" itemLabel="#{lv.label}" itemValue="#{lv.id}"/>
                    </h:selectOneMenu>
                   <p:message for="field_2_input" display="text"/>
                </h:panelGroup>

                <h:panelGroup rendered="#{monmgtBean.showFormType ne 'ROLEGROUP_MEDICAL'}">
                    <h:inputHidden value="#{monmgtBean.selectedOwnerUri}"/>
                </h:panelGroup>

                <h:panelGroup>
                    <h:outputLabel value="Display information about:"/>
                    <h:selectOneRadio id="field_3_input"
                                      required="true"  requiredMessage="Please choose"
                                      layout="pageDirection"
                                      value="#{monmgtBean.selectedLocalResourceType}">
                        <!--f:selectItem itemLabel="Please Select Information type" noSelectionOption="true"
                                      itemValue=""/-->
                        <f:selectItems
                                value="#{monmgtBean.modelFormLocalResources}"
                                var="lv" itemLabel="#{lv.label}" itemValue="#{lv.id}"/>
                    </h:selectOneRadio>


                    <p:message for="field_3_input" display="text"/>
                </h:panelGroup>


                <p:commandButton value="Find Patient Info"  rendered="#{monmgtBean.showFormType eq 'ROLEGROUP_MEDICAL'}"
                                 title="Find"
                                 image="ui-icon ui-icon-search"
                                 actionListener="#{monmgtBean.findResourcesByUserAndType}"
                                 ajax="false"/>

                <p:commandButton value="List Health Info"  rendered="#{monmgtBean.showFormType ne 'ROLEGROUP_MEDICAL'}"
                                 title="Find"
                                 image="ui-icon ui-icon-search"
                                 actionListener="#{monmgtBean.findResourcesByUserAndType}"
                                 ajax="false"/>
            </h:panelGroup>
            <!-- <p:spacer width="2px"/> -->
       <!--
        </p:toolbarGroup>
    </p:toolbar> <p:messages/>-->
</h:form>



<p>
Health information for:<p:spacer width="2px"/> <h:outputLabel value="#{monmgtBean.selectedOwnerGreetName}"/>
</p>
<!--
<p>
<h:outputLabel value="#{monmgtBean.selectedLocalResourceType}"/>
</p> -->

<h:form prependId="false">

    <p:dataTable widgetVar="widItemTableMonitormgt" id="idItemTableMonitormgt"
                 var="theItem" value="#{monmgtBean.modelMain}">

        <h:panelGroup rendered="#{monmgtBean.selectedLocalResourceType eq 'BP'}">
            <p:columnGroup type="header">

                <p:row>
                    <p:column headerText="#{labels['labels.menu.options.label']}"/>
                    <p:column headerText="#{labels['short.date.label']}" sortBy="#{theItem.beginDate}"/>
                    <p:column headerText="#{labels['obsBloodPressureA01.label']}" sortBy="#{theItem.systolic}"/>
                    <p:column headerText="#{labels['obsBloodPressureA01.bpHeartRate.label']}"
                              sortBy="#{theItem.heartRate}"/>
                    <p:column headerText="#{labels['default.comments.label']}"/>
                </p:row>
            </p:columnGroup>

            <p:column>
                <h:outputLabel value="#{theItem.beginDate}">
                    <f:convertDateTime pattern="yyyy-MM-dd"/>
                </h:outputLabel>
            </p:column>

            <p:column style="text-align:center;">
                <h:outputLabel value="#{theItem.systolic}"/>/<h:outputLabel value="#{theItem.diastolic}"/><h:outputLabel
                    value=" mmHg"/>
            </p:column>

            <p:column style="text-align:center;">
                <h:outputLabel value="#{theItem.heartRate}"/> <h:outputLabel value=" bpm"/>
            </p:column>


            <p:column>
                <h:outputText value="#{theItem.note}" rendered="#{monmgtBean.showFormType ne 'ROLEGROUP_MEDICAL'}"/>
            </p:column>


        </h:panelGroup>

        <h:panelGroup rendered="#{monmgtBean.selectedLocalResourceType eq 'BW'}">

            <p:column headerText="#{labels['short.dateStart.label']}" sortBy="#{theItem.beginDate}">
                <h:outputLabel value="#{theItem.beginDate}">
                    <f:convertDateTime pattern="yyyy-MM-dd" />
                </h:outputLabel>
            </p:column>

            <p:column headerText="#{labels['obsBodyWeightBMW01.label']}" sortBy="#{theItem.bodyWeight}">
                <h:outputLabel value="#{theItem.bodyWeight}" /> kg
            </p:column>
            <p:column headerText="#{labels['obsBodyWeightBMW01.bodyBMI.label']}" sortBy="#{theItem.bmi}" >
                <h:outputLabel value="#{theItem.bmi}" />
            </p:column>
            <p:column
                    headerText="#{labels['obsBodyWeightBMW01.height.label']}">
                <h:outputLabel value="#{theItem.bodyHeight}" /> cm
            </p:column>

            <p:column>
                <h:outputText value="#{theItem.note}" rendered="#{monmgtBean.showFormType ne 'ROLEGROUP_MEDICAL'}"/>
            </p:column>

        </h:panelGroup>

        <h:panelGroup rendered="#{monmgtBean.selectedLocalResourceType eq 'MED'}">

            monmgtBean


            <p:column headerText="#{labels['medicationSummary.medicationNameText.label']}">

                <h:outputLabel value="#{theItem.label}"/>
                <p:outputPanel rendered="#{theItem.code != null}">
                    <h:outputLabel value="#{theItem.code}" style="font-style:italic;" />
                </p:outputPanel>

                <p:outputPanel rendered="#{theItem.originStatus eq 'PHRS_INTEROP.IMPORT'}">
                    <!--<h:graphicImage title="#{labels['imported_medical_data']}" alt="#{labels['imported_medical_data']}" id="image1"
                                   value="/images/imported.png" />	-->

                    <h:outputLabel value="#{labels['imported_medical_data']}" style="font-style:italic;color:red;" />
                    <!--   do lookup for nice label e.g. originLabel or  use jstl 2.2
                <h:outputLabel value=" {theItem.origin}" style="font-style:italic;" />-->
                </p:outputPanel>

            </p:column>
            <p:column headerText="Start Date" >
                <h:outputText  value="#{theItem.beginDate}">
                    <f:convertDateTime pattern="yyyy-MM-dd" />
                </h:outputText>
            </p:column>

            <p:column headerText="Status" style="width:120px;">
                <h:outputText value="#{theItem.status}" >
                    <f:converter converterId="labelLookup" />
                </h:outputText>

            </p:column>


            <p:column headerText="End Date" >
                <h:outputText  value="#{theItem.endDate}">
                    <f:convertDateTime pattern="yyyy-MM-dd" />
                </h:outputText>
            </p:column>


            <p:column headerText="#{labels['default.medicationDosage.label']}" style="width:150px;">
                <h:outputLabel value="#{theItem.treatmentMatrix.dosage}"/>
                <p:spacer width="1"/>
                <h:outputLabel value="#{theItem.treatmentMatrix.dosageUnits}">
                    <f:converter converterId="labelLookup" />
                </h:outputLabel>
                <br/>
                <h:outputLabel value="#{theItem.treatmentMatrix.dosageInterval}">
                    <f:converter converterId="labelLookup" />
                </h:outputLabel>
                <br/>
                <h:outputLabel value="#{theItem.treatmentMatrix.dosageTimeOfDay}">
                    <f:converter converterId="labelLookup" />
                </h:outputLabel>
            </p:column>

            <p:column headerText="Reason">
                <h:outputLabel value="#{theItem.reasonCode}">
                    <f:converter converterId="labelLookup" />
                </h:outputLabel>
            </p:column>

            <p:column headerText="Prescribed by">

                <h:outputText value="#{theItem.prescribedByName}" />
            </p:column>

            <p:column headerText="#{labels['default.comments.label']}" rendered="#{monmgtBean.showFormType ne 'ROLEGROUP_MEDICAL'}">
                <h:outputText value="#{theItem.note}" />
            </p:column>

        </h:panelGroup>

        <h:panelGroup rendered="#{monmgtBean.selectedLocalResourceType eq 'ADL'}">

            <p:column headerText="#{labels['activityOfDailyLivingItem.activityCode.label']}">
                <h:outputLabel value="#{theItem.code}">
                    <f:converter converterId="labelLookup" />
                </h:outputLabel>
            </p:column>


            <p:column styleClass="innertable" headerText="#{labels['activityOfDailyLivingItem.valueActivity.label']}" >
                <h:outputLabel value="#{theItem.status}">
                    <f:converter converterId="labelLookup" />
                </h:outputLabel>
            </p:column>

            <p:column headerText="#{labels['default.comments.label']}" rendered="#{monmgtBean.showFormType ne 'ROLEGROUP_MEDICAL'}">
                <h:outputText value="#{theItem.note}" />
            </p:column>
        </h:panelGroup>

        <h:panelGroup rendered="#{monmgtBean.selectedLocalResourceType eq 'PROBLEM'}">

            <p:column headerText="#{labels['obsIssue.issueCode.label']}" sortBy="#{theItem.code}">
                <h:outputLabel value="#{theItem.code}" >
                    <f:converter converterId="labelLookup" />
                </h:outputLabel>
            </p:column>

            <p:column headerText="#{labels['default_status_problem']}" sortBy="#{theItem.status}">
                <h:outputLabel value="#{theItem.status}" >
                    <f:converter converterId="labelLookup" />
                </h:outputLabel>
            </p:column>

            <p:column headerText="#{labels['short.date.label']}" sortBy="#{theItem.displayDate}">
                <h:outputLabel value="#{theItem.displayDate}">
                    <f:convertDateTime pattern="yyyy-MM-dd" />
                </h:outputLabel>
            </p:column>

            <p:column headerText="#{labels['default.comments.label']}" rendered="#{monmgtBean.showFormType ne 'ROLEGROUP_MEDICAL'}">
                <h:outputText value="#{theItem.note}" />
            </p:column>
        </h:panelGroup>
    </p:dataTable>
    <!--
    <p:dataTable widgetVar="widItemTableMonitormgt" id="idItemTableMonitormgt"
                 var="theItem" value="#{monmgtBean.modelMain}">





             <p:column style="width:50px" headerText="View or Sort" sortBy="#{theItem.sortOrder}">

                 <p:outputPanel layout="block">


                     <p:commandButton actionListener="#{monmgtBean.downLoadReport}"
                         image="ui-icon ui-icon-disk"
                         title="#{labels['default.button.view.label']}">

                         <f:setPropertyActionListener value="#{theItem}"
                                                      target="#{monmgtBean.selected}" />
                     </p:commandButton>

                 </p:outputPanel>
             </p:column>

        <p:column headerText="User Name" sortBy="#{theItem.name}">
            <h:outputLabel value="#{theItem.name}"/>
        </p:column>

        <p:column headerText="Information Type"
                  sortBy="#{theItem.resourceType}">
            <h:outputLabel value="#{theItem.resourceType}">
                <f:converter converterId="labelLookup"/>
            </h:outputLabel>

            <p:outputPanel layout="block"
                           rendered="#{theItem.allowedViewContent eq true}">
                Access allowed
            </p:outputPanel>
            <p:outputPanel layout="block"
                           rendered="#{theItem.allowedViewContent eq false}">
                Access denied
            </p:outputPanel>

        </p:column>

        <p:column headerText="Message">
            <h:outputLabel value="#{theItem.message}"/>
        </p:column>

        <p:column headerText="PHR Identifier" sortBy="#{theItem.ownerUri}"
                  style="width:200px;word-wrap:break-word;">
            <h:outputLabel value="#{theItem.ownerUri}"/>
        </p:column>
        <p:column headerText="Protocol Identifier" sortBy="#{theItem.protocolId}"
                  style="width:200px;word-wrap:break-word;">
            <h:outputLabel value="#{theItem.protocolId}"/>
        </p:column>


        <p:column headerText="Test">
            <p:outputPanel layout="block">

                <p:commandButton actionListener="#{monmgtBean.downLoadTestingReport}"
                                 image="ui-icon ui-icon-disk"
                                 title="#{labels['default.button.view.label']}">

                    <f:setPropertyActionListener value="#{theItem}"
                                                 target="#{monmgtBean.selected}" />

                </p:commandButton>

            </p:outputPanel>
        </p:column>



    </p:dataTable>
    -->

</h:form>
</p:fieldset>
</ui:define>

</ui:composition>